<story-context id="bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>1</epicId>
    <storyId>1.1</storyId>
    <title>Projekt-Setup und Entwicklungsumgebung</title>
    <status>drafted</status>
    <generatedAt>2025-11-11</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>bmad-docs/stories/1-1-projekt-setup-und-entwicklungsumgebung.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>Entwickler</asA>
    <iWant>die grundlegende Projektstruktur und Entwicklungsumgebung aufsetzen</iWant>
    <soThat>ich eine solide Foundation für die MCP Server-Implementierung habe</soThat>
    <tasks>
- Python-Umgebung initialisieren (AC: 1, 2)
  - Python 3.11+ Installation verifizieren
  - Virtual Environment erstellen
  - Poetry installieren oder pip requirements setup

- Git-Repository initialisieren (AC: 1)
  - Git Repository erstellen
  - .gitignore erstellen (credentials, .env files, __pycache__, *.pyc, venv/, .pytest_cache/)
  - Initial commit

- Projektstruktur erstellen (AC: 1, 3)
  - Ordner anlegen: mcp_server/, tests/, docs/, config/, scripts/, streamlit_apps/, memory/, backups/, systemd/
  - MCP Server Unterordner: mcp_server/tools/, mcp_server/resources/, mcp_server/db/, mcp_server/external/, mcp_server/utils/
  - db/migrations/ Ordner für Schema-Migrationen

- Dependencies definieren und installieren (AC: 1, 2)
  - pyproject.toml (Poetry) oder requirements.txt erstellen mit Dependencies: mcp, psycopg2-binary, pgvector, openai, anthropic, numpy, streamlit, scipy, python-dotenv
  - Dev Dependencies: black, ruff, mypy, pytest, pytest-cov
  - Dependencies installieren

- Konfigurationsdateien erstellen (AC: 1, 4)
  - .env.template erstellen mit allen erforderlichen Variablen
  - .env.development erstellen (aus .env.template kopieren)
  - chmod 600 für .env.development setzen
  - config/config.yaml Template erstellen mit development: und production: Sections

- Pre-commit Hooks einrichten (AC: 2)
  - black Konfiguration in pyproject.toml
  - ruff Konfiguration in pyproject.toml
  - mypy Konfiguration in pyproject.toml oder mypy.ini
  - Pre-commit Framework installieren
  - .pre-commit-config.yaml erstellen mit Hooks
  - Pre-commit installieren und Test-Run durchführen

- Dokumentation initialisieren (AC: 1, 4)
  - README.md erstellen mit Projektübersicht, System-Requirements, Installation-Anleitung, Environment-Setup, Quick Start Guide
  - docs/ Ordner vorbereiten

- Verifizierung (AC: 1, 2, 4)
  - Virtual Environment aktivierbar
  - Dependencies importierbar
  - Pre-commit Hooks funktionieren
  - Git Repository initialisiert und .gitignore funktioniert
  - .env.development existiert mit chmod 600
  - config.yaml hat beide Environments
    </tasks>
  </story>

  <acceptanceCriteria>
AC1: Python-Projekt mit Dependencies
- Poetry oder pip requirements existiert (mcp, psycopg2, openai, anthropic, numpy, streamlit, scipy, python-dotenv)
- Git-Repository mit .gitignore (PostgreSQL credentials, .env Files)
- Projektstruktur: /mcp_server/, /tests/, /docs/, /config/
- Environment-Template (.env.template) für API-Keys und DB-Credentials
- README.md mit Setup-Anleitung

AC2: Entwicklungsumgebung lauffähig
- Python 3.11+ installiert
- Virtual Environment erstellt
- Dependencies installiert
- Pre-commit Hooks für Code-Qualität (black, ruff, mypy) konfiguriert und getestet
- .env.development erstellt (aus .env.template), PostgreSQL-Credentials placeholder

AC3: Projektstruktur vollständig (aus Architecture.md)
- /mcp_server/ mit Unterordnern: tools/, resources/, db/, external/, utils/
- /tests/ für Unit- und Integration-Tests
- /docs/ für Dokumentation
- /config/ für Konfigurationsdateien (.env.template, config.yaml)
- /scripts/ für Automation-Scripts
- /streamlit_apps/ für Ground Truth Labeling UI
- /memory/ für L2 Insights Git Backup (optional)
- /backups/ Placeholder für PostgreSQL Backups
- /systemd/ für Service-Konfiguration

AC4: Environment-Strategie dokumentiert
- .env.template vollständig dokumentiert alle erforderlichen Variablen
- .env.development erstellt (git-ignored, placeholder credentials)
- config.yaml hat development: und production: Sections
- README.md erklärt Environment-Setup (dev vs. prod)
- Dokumentiert: PostgreSQL-Installation kommt in Story 1.2
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>bmad-docs/architecture.md</path>
        <title>Cognitive Memory System v3.1.0-Hybrid - Architektur</title>
        <section>Projektstruktur</section>
        <snippet>Definiert vollständige Projektstruktur mit mcp_server/, tests/, docs/, config/, scripts/, streamlit_apps/, memory/, backups/, systemd/ Ordnern. Spezifiziert MCP Server Unterordner: tools/, resources/, db/, external/, utils/.</snippet>
      </doc>
      <doc>
        <path>bmad-docs/architecture.md</path>
        <title>Cognitive Memory System v3.1.0-Hybrid - Architektur</title>
        <section>Development Environment Setup</section>
        <snippet>Detaillierte Anleitung für PostgreSQL + pgvector Installation, Python Environment Setup mit Poetry, Environment Configuration (.env files), Database Migrations. Python 3.11+ erforderlich.</snippet>
      </doc>
      <doc>
        <path>bmad-docs/architecture.md</path>
        <title>Cognitive Memory System v3.1.0-Hybrid - Architektur</title>
        <section>Naming Conventions</section>
        <snippet>Python: Files snake_case.py, Classes PascalCase, Functions/Variables snake_case, Constants UPPER_SNAKE_CASE. Database: Tables snake_case, Columns snake_case. MCP: Tool Names snake_case, Resource URIs memory://{kebab-case}.</snippet>
      </doc>
      <doc>
        <path>bmad-docs/architecture.md</path>
        <title>Cognitive Memory System v3.1.0-Hybrid - Architektur</title>
        <section>Technologie-Entscheidungen</section>
        <snippet>Primary Language: Python 3.11+, MCP Server Framework: Python MCP SDK, Dependency Management: Poetry, Testing Strategy: Manual + Golden Test Set. Dependencies: mcp, psycopg2-binary, pgvector, openai, anthropic, numpy, streamlit, scipy, python-dotenv.</snippet>
      </doc>
      <doc>
        <path>bmad-docs/tech-spec-epic-1.md</path>
        <title>Epic 1: MCP Server Foundation & Ground Truth Collection - Technical Specification</title>
        <section>Story 1.1 - Projekt-Setup und Entwicklungsumgebung</section>
        <snippet>Definiert Projektstruktur-Setup mit Python 3.11+, Poetry/pip, Git Repository, .gitignore, Pre-commit Hooks (black, ruff, mypy), Environment-Templates (.env.template, .env.development), config.yaml mit dev/prod Sections.</snippet>
      </doc>
      <doc>
        <path>bmad-docs/tech-spec-epic-1.md</path>
        <title>Epic 1: MCP Server Foundation & Ground Truth Collection - Technical Specification</title>
        <section>Dependencies and Integrations</section>
        <snippet>Kern-Dependencies: mcp (Python MCP SDK), psycopg2-binary (PostgreSQL), pgvector (Vector DB), openai (Embeddings API), anthropic (Haiku API), numpy (Vektoren), streamlit (UI), scipy (Statistik), python-dotenv (Environment). Dev Dependencies: black, ruff, mypy, pytest, pytest-cov.</snippet>
      </doc>
      <doc>
        <path>bmad-docs/epics.md</path>
        <title>Cognitive Memory System - Epics and Stories</title>
        <section>Epic 1: MCP Server Foundation & Ground Truth Collection - Story 1.1</section>
        <snippet>Story 1.1: Projekt-Setup und Entwicklungsumgebung. Ziel: Python Environment, Projektstruktur, Dependencies, Git Repository, Pre-commit Hooks, Environment-Templates, README.md. Aufwand: 3-4h. Foundation-Story für alle nachfolgenden Stories.</snippet>
      </doc>
      <doc>
        <path>bmad-docs/PRD.md</path>
        <title>Cognitive Memory System - Product Requirements Document (PRD)</title>
        <section>Technical Architecture - MCP Server Components</section>
        <snippet>Language: Python (D1), Tech Stack: mcp (Python MCP SDK), psycopg2 (PostgreSQL + pgvector), openai (Embeddings API + GPT-4o API), anthropic (Haiku API), numpy (Vector Operations). 7 MCP Tools und 5 MCP Resources definiert.</snippet>
      </doc>
    </docs>
    <code>
      <!-- No existing code - greenfield project setup story -->
      <note>This is the foundation story (1.1) that creates the initial project structure. No existing MCP server code to reference. Future stories will build on this foundation.</note>
    </code>
    <dependencies>
      <python>
        <runtime>Python 3.11+</runtime>
        <package-manager>Poetry (preferred) or pip</package-manager>
        <core-dependencies>
          <dep name="mcp" purpose="Python MCP SDK for server implementation" />
          <dep name="psycopg2-binary" purpose="PostgreSQL database adapter" />
          <dep name="pgvector" purpose="pgvector Python client for vector operations" />
          <dep name="openai" purpose="OpenAI API client (Embeddings + GPT-4o)" />
          <dep name="anthropic" purpose="Anthropic API client (Haiku)" />
          <dep name="numpy" purpose="Vector operations and numerical computing" />
          <dep name="streamlit" purpose="Ground Truth Labeling UI" />
          <dep name="scipy" purpose="Statistical functions (Cohen's Kappa)" />
          <dep name="python-dotenv" purpose="Environment variable management" />
        </core-dependencies>
        <dev-dependencies>
          <dep name="black" purpose="Code formatter (PEP 8)" />
          <dep name="ruff" purpose="Fast Python linter" />
          <dep name="mypy" purpose="Static type checker" />
          <dep name="pytest" purpose="Testing framework" />
          <dep name="pytest-cov" purpose="Test coverage reporting" />
          <dep name="pre-commit" purpose="Git hooks framework" />
        </dev-dependencies>
      </python>
      <system-requirements>
        <req>PostgreSQL 15+ (will be installed in Story 1.2)</req>
        <req>pgvector extension (will be installed in Story 1.2)</req>
        <req>Git version control</req>
      </system-requirements>
    </dependencies>
  </artifacts>

  <constraints>
    <constraint id="C1" type="language">
      <rule>Python 3.11+ REQUIRED for Type Hints (PEP 646, PEP 673), async/await, MCP SDK compatibility</rule>
      <source>architecture.md - Technologie-Entscheidungen</source>
    </constraint>
    <constraint id="C2" type="naming">
      <rule>Files: snake_case.py, Classes: PascalCase, Functions/Variables: snake_case, Constants: UPPER_SNAKE_CASE</rule>
      <source>architecture.md - Naming Conventions</source>
    </constraint>
    <constraint id="C3" type="structure">
      <rule>Projektstruktur MUSS architecture.md folgen: mcp_server/{tools,resources,db,external,utils}, tests/, docs/, config/, scripts/, streamlit_apps/, memory/, backups/, systemd/</rule>
      <source>architecture.md - Projektstruktur</source>
    </constraint>
    <constraint id="C4" type="security">
      <rule>.env Files MÜSSEN chmod 600 haben (nur Owner readable). .env.development und .env.production MÜSSEN git-ignored sein.</rule>
      <source>architecture.md - Security & Privacy</source>
    </constraint>
    <constraint id="C5" type="code-quality">
      <rule>Pre-commit Hooks sind NICHT optional - black, ruff, mypy MÜSSEN konfiguriert und funktionsfähig sein. Konsistente Code-Qualität kritisch für 33-Story-Projekt.</rule>
      <source>story 1.1 - Dev Notes - Code-Qualität Tools</source>
    </constraint>
    <constraint id="C6" type="environment">
      <rule>Drei-Schichten Environment-Management: .env.template (git-committed, dokumentiert alle Vars), .env.development (git-ignored, placeholder credentials), .env.production (git-ignored, Story 3.7), config.yaml (git-committed, dev/prod sections)</rule>
      <source>story 1.1 - Dev Notes - Environment Variables</source>
    </constraint>
    <constraint id="C7" type="boundary">
      <rule>PostgreSQL wird NICHT in Story 1.1 getestet - nur Dependencies installieren. DB-Setup kommt in Story 1.2. README.md MUSS dies explizit dokumentieren.</rule>
      <source>story 1.1 - Dev Notes - PostgreSQL Availability Testing</source>
    </constraint>
    <constraint id="C8" type="dependency-management">
      <rule>Poetry bevorzugt für Type-safe Dependency Resolution, Lockfile, moderne Best Practices. pip requirements.txt als Fallback akzeptabel.</rule>
      <source>architecture.md - Technologie-Entscheidungen</source>
    </constraint>
  </constraints>

  <interfaces>
    <!-- No interfaces to define yet - Story 1.1 creates foundation only -->
    <note>Future stories will define MCP Tool and Resource interfaces. Story 1.1 establishes project structure only.</note>
  </interfaces>
  <tests>
    <standards>
Testing for Story 1.1 is primarily verification-based (manual checks) rather than automated unit tests. Future stories will implement automated tests using pytest framework.

Testing Strategy (from architecture.md):
- Manual Testing (Epic 1-2): Manual testing in Claude Code interface, no automated unit tests for personal use
- Integration Testing (Epic 2): End-to-End RAG Pipeline tests
- Validation Testing (Epic 3): Golden Test Set (50-100 Queries), 7-Day Stability Test

For Story 1.1 specifically:
- Dev Dependencies installed: pytest, pytest-cov
- Pre-commit framework tested: `pre-commit run --all-files` must pass
- Manual verification of environment setup, dependencies importable, permissions correct
    </standards>
    <locations>
      <location>tests/ (created empty in Story 1.1, populated in future stories)</location>
      <location>.pre-commit-config.yaml (must exist and be functional)</location>
      <location>pyproject.toml or mypy.ini (type checker config)</location>
    </locations>
    <ideas>
      <idea ac="AC1">
        <test>Verify pyproject.toml or requirements.txt exists and contains all required dependencies (mcp, psycopg2-binary, pgvector, openai, anthropic, numpy, streamlit, scipy, python-dotenv)</test>
        <approach>Read file, parse dependencies, check each core + dev dependency present</approach>
      </idea>
      <idea ac="AC1">
        <test>Verify .gitignore exists and contains critical entries: .env.development, .env.production, __pycache__/, *.pyc, venv/, .pytest_cache/</test>
        <approach>Read .gitignore, check each pattern present</approach>
      </idea>
      <idea ac="AC2">
        <test>Verify Python 3.11+ installed: python3.11 --version returns valid version</test>
        <approach>Execute command, parse version string, assert >= 3.11</approach>
      </idea>
      <idea ac="AC2">
        <test>Verify all dependencies importable: python -c "import mcp, psycopg2, openai, anthropic, numpy, streamlit, scipy"</test>
        <approach>Execute import command, assert no ImportError</approach>
      </idea>
      <idea ac="AC2">
        <test>Verify pre-commit hooks functional: pre-commit run --all-files executes without errors</test>
        <approach>Execute command in venv, assert exit code 0</approach>
      </idea>
      <idea ac="AC3">
        <test>Verify complete project structure exists: all directories from architecture.md present</test>
        <approach>Check existence of: mcp_server/{tools,resources,db,external,utils}, tests/, docs/, config/, scripts/, streamlit_apps/, memory/, backups/, systemd/</approach>
      </idea>
      <idea ac="AC4">
        <test>Verify .env.development exists with chmod 600 permissions</test>
        <approach>Check file exists, stat file, assert permissions = 0600</approach>
      </idea>
      <idea ac="AC4">
        <test>Verify config.yaml has both development: and production: sections</test>
        <approach>Read config.yaml, parse YAML, assert both keys present</approach>
      </idea>
    </ideas>
  </tests>
</story-context>
